
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />


  <link rel="canonical" href="https://andrewwegner.com/connect-python-to-osi-soft-pi.html">

  <meta name="robots" content="index, follow" />

  <link
    href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=block"
    rel="stylesheet">

  <link rel="stylesheet" type="text/css" href="https://andrewwegner.com/theme/stylesheet/style.min.css">
  <link rel="stylesheet" type="text/css"
    href="https://andrewwegner.com/theme/font-awesome/css/font-awesome-v4.css">


  <link id="pygments-light-theme" rel="stylesheet" type="text/css"     href="https://andrewwegner.com/theme/pygments/github.min.css">



  <link rel="stylesheet" type="text/css" href="https://andrewwegner.com/theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="https://andrewwegner.com/theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="https://andrewwegner.com/theme/font-awesome/css/solid.css">


<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
<link rel="icon" href="/favicon.ico" type="image/x-icon">
<link rel="apple-touch-icon" sizes="180x180" href=" /apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">

  <!-- Chrome, Firefox OS and Opera -->
  <meta name="theme-color" content="#080019">
  <!-- Windows Phone -->
  <meta name="msapplication-navbutton-color" content="#080019">
  <!-- iOS Safari -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <!-- Microsoft EDGE -->
  <meta name="msapplication-TileColor" content="#080019">

  <link href="https://andrewwegner.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Ponderings of an Andy Atom">


<script type="text/javascript">
    window.heap = window.heap || [], heap.load = function (e, t) { window.heap.appid = e, window.heap.config = t = t || {}; var r = t.forceSSL || "https:" === document.location.protocol, a = document.createElement("script"); a.type = "text/javascript", a.async = !0, a.src = (r ? "https:" : "http:") + "//cdn.heapanalytics.com/js/heap-" + e + ".js"; var n = document.getElementsByTagName("script")[0]; n.parentNode.insertBefore(a, n); for (var o = function (e) { return function () { heap.push([e].concat(Array.prototype.slice.call(arguments, 0))) } }, p = ["addEventProperties", "addUserProperties", "clearEventProperties", "identify", "resetIdentity", "removeEventProperty", "setEventProperties", "track", "unsetEventProperty"], c = 0; c < p.length; c++)heap[p[c]] = o(p[c]) };
    heap.load("653100411");
</script>

<meta name="author" content="Andy Wegner" />
<meta name="description" content="How I connected Python to OSI Soft PI" />
<meta name="keywords" content="technical">


  <meta property="og:site_name" content="Ponderings of an Andy"/>
  <meta property="og:title" content="Connect Python to OSI Soft PI"/>
  <meta property="og:description" content="How I connected Python to OSI Soft PI"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:url" content="https://andrewwegner.com/connect-python-to-osi-soft-pi.html"/>
  <meta property="og:type" content="article"/>
  <meta property="article:published_time" content="2012-02-07 12:45:00-06:00"/>
  <meta property="article:modified_time" content="2012-04-16 00:00:00-05:00"/>
  <meta property="article:author" content="https://andrewwegner.com/author/andy-wegner.html">
  <meta property="article:section" content="Technical Solutions"/>
  <meta property="article:tag" content="technical"/>
  <meta property="og:image" content="/images/wegner_headshot.png">

  <title>Connect Python to OSI Soft PI  Â· Ponderings of an Andy
</title>

</head>

<body class="light-theme" >

<aside class="aside-border">
  <div>
    <a href="https://andrewwegner.com/">
      <img class="hex-logo" src="/images/wegner_headshot.png" alt="Ponderings of an Andy" title="Ponderings of an Andy">
    </a>


    <nav>
      <ul class="list">



        <li>
          <a target="_self" href="/">Home</a>
        </li>
        <li>
          <a target="_self" href="/about/">About Me</a>
        </li>
        <li>
          <a target="_self" href="/archives.html">Archives</a>
        </li>
        <li>
          <a target="_self" href="/categories.html">Categories</a>
        </li>
        <li>
          <a target="_self" href="/tags.html">Tags</a>
        </li>
      </ul>
    </nav>


    <ul class="social">
      <div class="itsmefooter">Andy Wegner</div>
      <li>
        <a id="andy-linkedin" class="sc-linkedin" rel="me"  href="https://www.linkedin.com/in/andrew-wegner/"
          target="_blank">
          <i class="fa-brands fa-linkedin"></i>
        </a>
      </li>
      <li>
        <a id="andy-stackoverflow" class="sc-stack-overflow" rel="me"  href="https://stackoverflow.com/users/189134/andy"
          target="_blank">
          <i class="fa-brands fa-stack-overflow"></i>
        </a>
      </li>
      <li>
        <a id="andy-github" class="sc-github" rel="me"  href="https://github.com/AWegnerGitHub/"
          target="_blank">
          <i class="fa-brands fa-github"></i>
        </a>
      </li>
      <li>
        <a id="andy-resume" class="sc-file-pdf"  href="/resume.pdf"
          target="_blank">
          <i class="fa-solid fa-file-pdf"></i>
        </a>
      </li>
      <li>
        <a id="andy-blogemail" class="sc-envelope" rel="me"  href="mailto:blog.feedback@andrewwegner.com"
          target="_blank">
          <i class="fa-solid fa-envelope"></i>
        </a>
      </li>
    </ul>
  </div>

</aside>
  <main>

<article class="single">
  <header>
    
<nav>
    <ul class="article-breadcrumbs">
        <li><a href="/"><i class="fa-sharp fa-solid fa-house"></i>&nbsp;Home</a></li>
        <li><i class="fa-solid fa-greater-than"></i>&nbsp;<a href="https://andrewwegner.com/categories.html">Categories</a></li>
        <li><i class="fa-solid fa-greater-than"></i>&nbsp;<a href="https://andrewwegner.com/category/technical-solutions.html">Technical Solutions</a>
        </li>
        <li><i class="fa-solid fa-greater-than"></i>&nbsp;<a href="https://andrewwegner.com/connect-python-to-osi-soft-pi.html"><i
                    class="fa-solid fa-book"></i>&nbsp;<span class="breadcrumb-article">Connect Python to OSI Soft PI</span></li></a></li>
    </ul>
</nav>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
  {
    "@type": "ListItem",
    "position": 1,
    "item": 
    {
      "@id": "/",
      "name": "Ponderings of an Andy"
    }
  },
  {
    "@type": "ListItem",
    "position": 2,
    "item": 
    {
      "@id": "https://andrewwegner.com/categories.html",
      "name": "Categories"
    }
  }
  ,{
    "@type": "ListItem",
    "position": 3,
    "item": 
    {
      "@id": "https://andrewwegner.com/category/technical-solutions.html",
      "name": "Technical Solutions"
    }
  }
  ,{
    "@type": "ListItem",
    "position": 4,
    "item": 
    {
      "@id": "https://andrewwegner.com/connect-python-to-osi-soft-pi.html",
      "name": "https://andrewwegner.com/connect-python-to-osi-soft-pi.html"
    }
  }
  ]
}
</script>    <h1 id="connect-python-to-osi-soft-pi">Connect Python to OSI Soft PI</h1>
    <p>
      Posted on Tue 07 February 2012 in <a href="https://andrewwegner.com/category/technical-solutions.html">Technical Solutions</a>

      <br />Updated on Mon 16 Apr 2012

    <div class="tag-cloud">
      <p>
        <a href="https://andrewwegner.com/tag/technical.html">technical</a>
      </p>
    </div>
    </p>
  </header>

  <div>
    <p>OSI PI is a historian database. I had a task to connect a python application to this database. I asked a question on
<a href="http://stackoverflow.com/questions/8898114/how-can-i-connect-python-2-6-to-osi-pi">Stack Overflow</a> about whether this was a simple problem to solve. After two weeks I still hadn't gotten a viable response,
so I had to build by own solution.</p>
<p>I did reach out to the vendor first for help. Their response back was not helpful.</p>
<blockquote>
<p>Looks like pyodbc is written against ODBC 3.x.  The OSI PI ODBC driver is using ODBC 2.0.  The python ODBC driver manager
will convert most ODBC 3 calls on the fly to ODBC 2 ones. Anything added to 3, however, will obviously fail. You would
need to find some way to make sure that your only using 2.0 compliant ODBC calls.  Currently their is not a PI ODBC
driver that is compliant with ODBC 3.0.</p>
</blockquote>
<p>So, it looks like the vendor doesn't support Python (odd, they are named "PI", but I digress). Additionally, the drivers provided
by the company initially didn't work.</p>
<p>The code below shows how I was able to finally connect python to OSI PI. It may not be the most elegant, but it
functions for the purposes of my application. Initially I was attempting to connect using the <a href="https://github.com/mkleehammer/pyodbc">pyodbc</a> module. Unfortunately,
OSI PI would return a message like this:</p>
<div class="codehilight code"><pre><span></span><code><span class="n">pyodbc</span><span class="p">.</span><span class="n">Error</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="err">&#39;</span><span class="n">IM002</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;[IM002] [OSI][PI ODBC][PI]PI-API Error &lt;pilg_getdefserverinfo&gt; 0 (0) (SQLDriverConnectW); [01000] [Microsoft][ODBC Driver Manager] The driver doesn&#39;t support the version of ODBC behavior that the application requested (see SQLSetEnvAttr). (0)&quot;</span><span class="p">)</span><span class="w"></span>
</code></pre></div>

<p>They vendor mentioned that using OLEDB instead may prove more fruitful. Thus, the code below is how I got connected using 
the vendor provided OLDEB driver. The downside is that I also had to do this all through COM objects using <a href="http://python.net/crew/skippy/win32/Downloads.html">win32com</a>. 
I'm not knocking the module, because it is extremely useful and I've done some great things with it.</p>
<div class="codehilight code"><pre><span></span><code><span class="kn">from</span> <span class="nn">win32com.client</span> <span class="kn">import</span> <span class="n">Dispatch</span>

<span class="n">oConn</span> <span class="o">=</span> <span class="n">Dispatch</span><span class="p">(</span><span class="s1">&#39;ADODB.Connection&#39;</span><span class="p">)</span>
<span class="n">oRS</span> <span class="o">=</span> <span class="n">Dispatch</span><span class="p">(</span><span class="s1">&#39;ADODB.RecordSet&#39;</span><span class="p">)</span>

<span class="n">oConn</span><span class="o">.</span><span class="n">ConnectionString</span> <span class="o">=</span> <span class="s2">&quot;Provider=PIOLEDB;Data Source=&lt;server&gt;;User ID=&lt;username&gt;;database=&lt;database&gt;;Password=&lt;password&gt;&quot;</span>
<span class="n">oConn</span><span class="o">.</span><span class="n">Open</span><span class="p">()</span>

<span class="k">if</span> <span class="n">oConn</span><span class="o">.</span><span class="n">State</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="nb">print</span> <span class="s2">&quot;We&#39;ve connected to the database.&quot;</span>
    <span class="n">db_cmd</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;SELECT tag FROM pipoint WHERE tag LIKE &#39;TAG0001%&#39;&quot;&quot;&quot;</span>
    <span class="n">oRS</span><span class="o">.</span><span class="n">ActiveConnection</span> <span class="o">=</span> <span class="n">oConn</span>
    <span class="n">oRS</span><span class="o">.</span><span class="n">Open</span><span class="p">(</span><span class="n">db_cmd</span><span class="p">)</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="n">oRS</span><span class="o">.</span><span class="n">EOF</span><span class="p">:</span>
        <span class="c1">#print oRS.Fields.Item(&quot;tag&quot;).Value   # Ability to print by a field name</span>
        <span class="nb">print</span> <span class="n">oRS</span><span class="o">.</span><span class="n">Fields</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">Value</span>        <span class="c1"># Ability to print by a field location</span>
        <span class="n">oRS</span><span class="o">.</span><span class="n">MoveNext</span><span class="p">()</span>
    <span class="n">oRS</span><span class="o">.</span><span class="n">Close</span><span class="p">()</span>
    <span class="n">oRS</span> <span class="o">=</span> <span class="kc">None</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span> <span class="s2">&quot;Not connected&quot;</span>

<span class="k">if</span> <span class="n">oConn</span><span class="o">.</span><span class="n">State</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">oConn</span><span class="o">.</span><span class="n">Close</span><span class="p">()</span>
<span class="n">oConn</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div>

<p>I followed up on my Stack Overflow post about 2 months after posting my solution with the following note:</p>
<blockquote>
<p>Just following up on this after using it for a couple months. This is still the only way I've found to do this with 
python, but it seems to be very slow when I need to run a large number of queries. I suspect it is because I have to 
open/close the database connection for each query, but OSI PI/ADODB complains if I do not. Performance has not reached a 
point where I am forced to rewrite this yet. If/when I do I will follow up again. In the meantime others using this 
solution should be aware that it is slow when running many queries.</p>
</blockquote>
  </div>
<div class="neighbors">
  <a class="btn float-left" href="https://andrewwegner.com/a-new-more-fair-rtd.html"
    title="A new, more fair, RTD">
    <i class="fa fa-angle-left"></i> Previous Post
  </a>
  <a class="btn float-right" href="https://andrewwegner.com/monitoring-language-on-the-game-servers.html"
    title="Monitoring Language on the game servers">
    Next Post <i class="fa fa-angle-right"></i>
  </a>
</div>
  <hr />
  <div>
            <span class="author_blurb"><a href="https://andrewwegner.com/" rel="author"><span class="author_name">Andy Wegner</span></a> -
             is a father, an engineer and a computer scientist. He is interested in online
            community building, tinkering with new code and building new applications.
            He writes about his experiences with each of these.</span>

  </div>


</article>

<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "name": "Connect Python to OSI Soft PI",
  "headline": "Connect Python to OSI Soft PI",
  "dateCreated": "2012-02-07 12:45:00-06:00",
  "datePublished": "2012-02-07 12:45:00-06:00",
  "dateModified": "2012-04-16 00:00:00-05:00",
  "copyrightYear": "2012",
  "copyrightHolder": {
    "@type": "Person",
    "name": "Andy Wegner",
    "url": "https://andrewwegner.com"
  },
  "author": {
    "@type": "Person",
    "name": "Andy Wegner",
    "sameAs": [
      "https://www.andrewwegner.com/about/"
      ],
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https://www.andrewwegner.com/about/"
      }
  },
  "publisher": {
    "@type": "Person",
    "name": "Andy Wegner",
    "sameAs": [
      "https://www.andrewwegner.com/about/"
      ]
  },
  "image": "/images/wegner_headshot.png",
  "url": "https://andrewwegner.com/connect-python-to-osi-soft-pi.html",
  "description": "How I connected Python to OSI Soft PI",
  "mainEntityOfPage": "True",
  "articleSection": "Technical Solutions"
}
</script>
<footer>
<p>&copy; 2022 Andrew Wegner</p>
</footer>  </main>

<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Ponderings of an Andy ",
  "url" : "https://andrewwegner.com",
  "image": "/images/wegner_headshot.png",
  "description": "Articles and reviews covering thoughts on work place leadership, technical course reviews, and other ponderings of Andy"
}
</script>
</body>

</html>